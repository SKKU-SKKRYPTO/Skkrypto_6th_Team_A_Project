{"ast":null,"code":"/*\n    Modifications copyright 2018 The caver-js Authors\n    This file is part of the web3.js library.\n\n    The web3.js library is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    The web3.js library is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with the web3.js. If not, see <http://www.gnu.org/licenses/>.\n\n    This file is derived from web3.js/packages/web3/src/index.js (2019/06/12).\n    Modified and improved for the caver-js development.\n*/\n\n/**\n * @file index.js\n * @authors:\n *   Fabian Vogelsteller <fabian@ethereum.org>\n *   Gav Wood <gav@parity.io>\n *   Jeffrey Wilcke <jeffrey.wilcke@ethereum.org>\n *   Marek Kotewicz <marek@parity.io>\n *   Marian Oancea <marian@ethereum.org>\n * @date 2017\n */\nglobal.rootRequire = name => require(\"\".concat(__dirname, \"/packages/\").concat(name, \"/src/index.js\"));\n\nconst _require = require('./packages/caver-core'),\n      packageInit = _require.packageInit,\n      providers = _require.providers;\n\nconst Klay = require('./packages/caver-klay');\n\nconst Account = require('./packages/caver-account');\n\nconst KeyringContainer = require('./packages/caver-wallet');\n\nconst Transaction = require('./packages/caver-transaction');\n\nconst RPC = require('./packages/caver-rpc');\n\nconst abi = require('./packages/caver-abi');\n\nconst BaseContract = require('./packages/caver-contract');\n\nconst KCT = require('./packages/caver-kct');\n\nconst Validator = require('./packages/caver-validator');\n\nconst core = require('./packages/caver-core');\n\nconst middleware = require('./packages/caver-middleware');\n\nconst utils = require('./packages/caver-utils');\n\nconst formatters = require('./packages/caver-core-helpers').formatters;\n\nconst IPFS = require('./packages/caver-ipfs');\n\nconst _require2 = require('./package.json'),\n      version = _require2.version;\n/**\n * A caver class implemented to use Klaytn easily.\n *\n * @example\n * const Caver = require('caver-js')\n * const caver = new Caver('http://{your en url}:{port}')\n *\n * // If you want to create a provider, you can do like below.\n * const httpProvider = new Caver.providers.HttpProvider('http://{your en url}:{port}')\n * const caver = new Caver(httpProvider)\n *\n * // Use websocket provider with Caver.\n * const websocketProvider = new Caver.providers.WebsocketProvider('ws://{your en url}:{port}')\n * const caver = new Caver(websocketProvider)\n * caver.currentProvider.connection.close()\n *\n * @class\n * @constructor\n * @param {string|HttpProvider|WebsocketProvider|IpcProvider} [provider] - The url string of the Node to connect with. You can pass the provider instance directly.\n */\n\n\nfunction Caver(provider, net) {\n  const _this = this;\n\n  this.use = middleware.registerMiddleware.bind(middleware); // sets _requestmanager etc\n\n  packageInit(this, [provider, net]);\n  /** @type {string} */\n\n  this.version = version;\n  /** @type {module:utils} */\n\n  this.utils = utils;\n  /** @type {typeof Account} */\n\n  this.account = Account;\n  /** @type {module:Transaction} */\n\n  this.transaction = Transaction;\n  /** @type {ABI} */\n\n  this.abi = abi;\n  /** @type {KeyringContainer} */\n\n  this.wallet = new KeyringContainer(); // ex) call `caver.klay.property` || `caver.klay.method(...)`\n\n  /** @type {KCT} */\n\n  this.kct = new KCT(this);\n  this.klay = new Klay(this);\n  /** @type {RPC} */\n\n  this.rpc = new RPC(this);\n  /** @type {Validator} */\n\n  this.validator = new Validator();\n  /** @type {IPFS} */\n\n  this.ipfs = new IPFS(); // overwrite package setProvider\n\n  const setProvider = this.setProvider;\n  /**\n   * Changes the current provider of the Caver.\n   * You can access the provider's constructor via `const Caver = require('caver-js'); const provider = new Caver.providers.XXXProvider('...')`.\n   *\n   * @example\n   * const isSet = caver.setProvider('http://{your en url}:{port}')\n   * const isSet = caver.setProvider(new Caver.providers.HttpProvider('http://{your en url}:{port}'))\n   *\n   * const isSet = caver.setProvider('ws://{your en url}:{port}')\n   * const isSet = caver.setProvider(new Caver.providers.WebsocketProvider('http://{your en url}:{port}'))\n   *\n   * @param {string|HttpProvider|WebsocketProvider|IpcProvider} p - The url string of the Node or the provider instance.\n   * @return {boolean} `true` means provider is set successfully.\n   */\n\n  this.setProvider = (p, n) => {\n    setProvider.apply(this, [p, n]);\n\n    _this.klay.setRequestManager(_this._requestManager);\n\n    _this.rpc.setRequestManager(_this._requestManager);\n\n    _this.kct.setRequestManager(_this._requestManager);\n\n    _this.contract._requestManager = _this._requestManager;\n    _this.contract.currentProvider = _this._provider;\n    return true;\n  };\n\n  const self = this;\n\n  const Contract = function Contract() {\n    BaseContract.apply(this, arguments);\n    core.packageInit(this, [self]);\n    this.setWallet(self.wallet);\n  };\n\n  Contract.create = function () {\n    // With `caver.contract`, `caver.wallet` must be set in the `contarct._wallet`,\n    // so the Contract constructor defined above must be called here.\n    return new Contract(...arguments);\n  };\n\n  Contract.setProvider = function () {\n    BaseContract.setProvider.apply(this, arguments);\n  };\n\n  Contract.prototype = Object.create(BaseContract.prototype);\n  Contract.prototype.constructor = Contract;\n  /** @type {typeof Contract} */\n\n  this.contract = Contract;\n  this.contract._requestManager = this._requestManager;\n  this.contract.currentProvider = this._requestManager.provider;\n}\n/**\n * @type {module:utils}\n *\n * @example\n * const utils = require('caver-js').utils\n * */\n\n\nCaver.utils = utils;\n/**\n * @type {ABI}\n *\n * @example\n * const abi = require('caver-js').abi\n * */\n\nCaver.abi = abi;\n/**\n * The account key types which are used in the `caver.account` package.\n *\n * @typedef {object} Caver.Providers\n * @property {typeof WebsocketProvider} WebsocketProvider - Class representing WebsocketProvider.\n * @property {typeof HttpProvider} HttpProvider - Class representing HttpProvider.\n * @property {typeof IpcProvider} IpcProvider - Class representing IpcProvider.\n */\n\n/**\n * @type {Caver.Providers}\n *\n * @example\n * const providers = require('./index').providers\n * */\n\nCaver.providers = providers;\nmodule.exports = Caver;\nmodule.exports.formatters = formatters;","map":null,"metadata":{},"sourceType":"script"}